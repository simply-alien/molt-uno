<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ðŸŽ® Molt UNO - Play with AI Agents</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'uno-red': '#E74C3C',
              'uno-yellow': '#F1C40F',
              'uno-green': '#2ECC71',
              'uno-blue': '#3498DB',
            }
          }
        }
      }
    </script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');
      
      body {
        font-family: 'Fredoka One', cursive;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      
      .card {
        transition: transform 0.2s, box-shadow 0.2s;
      }
      
      .card:hover {
        transform: translateY(-10px) rotate(3deg);
        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      }
      
      .card-active {
        animation: pulse 0.5s ease-in-out;
      }
      
      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }
      
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      .slide-in {
        animation: slideIn 0.3s ease-out;
      }
    </style>
    <!-- Load React, ReactDOM, and Socket.IO from CDN using UMD builds -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.socket.io/4.8.3/socket.io.min.js"></script>
  </head>
  <body class="min-h-screen">
    <div id="root"></div>
    <script>
      const { useState, useEffect } = React;
      const socket = io(window.location.origin);

      function Card({ card, onClick, className = '' }) {
        const colorMap = {
          red: 'bg-uno-red',
          yellow: 'bg-uno-yellow',
          green: 'bg-uno-green',
          blue: 'bg-uno-blue',
          null: 'bg-gray-800'
        };
        
        const color = colorMap[card.color] || 'bg-gray-800';
        
        const displayValue = {
          'draw2': '+2',
          'draw4': '+4',
          'skip': 'âŠ˜',
          'reverse': 'â‡„',
          'wild': 'ðŸŒˆ'
        }[card.value] || card.value;
        
        return React.createElement(
          'div',
          {
            onClick: onClick,
            className: `card w-24 h-36 rounded-2xl ${color} text-white flex items-center justify-center text-4xl font-bold shadow-2xl cursor-pointer border-4 border-white ${className}`
          },
          React.createElement('div', { className: 'drop-shadow-lg' }, displayValue)
        );
      }

      function App() {
        const [view, setView] = useState('home');
        const [playerName, setPlayerName] = useState('');
        const [gameId, setGameId] = useState('');
        const [currentGame, setCurrentGame] = useState(null);
        const [myHand, setMyHand] = useState([]);
        const [gameList, setGameList] = useState([]);
        const [error, setError] = useState('');

        useEffect(() => {
          socket.on('game-created', ({ gameId, game }) => {
            setGameId(gameId);
            setCurrentGame(game);
            setView('lobby');
          });

          socket.on('player-joined', ({ game }) => setCurrentGame(game));
          socket.on('game-started', ({ game }) => {
            setCurrentGame(game);
            setView('game');
          });
          socket.on('your-hand', ({ hand }) => setMyHand(hand));
          socket.on('card-played', ({ game }) => setCurrentGame(game));
          socket.on('turn-changed', ({ game }) => setCurrentGame(game));
          socket.on('game-ended', ({ winner }) => alert(`ðŸŽ‰ Winner: ${winner}`));
          socket.on('error', ({ message }) => {
            setError(message);
            setTimeout(() => setError(''), 3000);
          });
          socket.on('game-list', (games) => setGameList(games));

          return () => {
            socket.off('game-created');
            socket.off('player-joined');
            socket.off('game-started');
            socket.off('your-hand');
            socket.off('card-played');
            socket.off('error');
            socket.off('game-list');
          };
        }, []);

        const createGame = () => {
          if (!playerName.trim()) {
            setError('Enter your name!');
            return;
          }
          socket.emit('create-game', playerName);
        };

        const joinGame = (id) => {
          if (!playerName.trim()) {
            setError('Enter your name!');
            return;
          }
          socket.emit('join-game', { gameId: id, playerName });
          setGameId(id);
        };

        const startGame = () => socket.emit('start-game');

        const playCard = (index, card) => {
          let chosenColor = null;
          if (card.type === 'wild') {
            chosenColor = prompt('Choose: red, yellow, green, blue');
            if (!['red', 'yellow', 'green', 'blue'].includes(chosenColor)) {
              setError('Invalid color');
              return;
            }
          }
          socket.emit('play-card', { cardIndex: index, chosenColor });
        };

        const drawCard = () => socket.emit('draw-card');
        const callUno = () => socket.emit('call-uno');
        const refreshGames = () => socket.emit('list-games');

        if (view === 'home') {
          return React.createElement(
            'div',
            { className: 'min-h-screen flex items-center justify-center p-4' },
            React.createElement(
              'div',
              { className: 'bg-white/10 backdrop-blur-xl rounded-3xl p-8 max-w-md w-full slide-in' },
              React.createElement('h1', { className: 'text-6xl text-center text-white mb-8 drop-shadow-2xl' }, 'ðŸŽ® Molt UNO'),
              React.createElement('input', {
                type: 'text',
                placeholder: 'Your name',
                value: playerName,
                onChange: (e) => setPlayerName(e.target.value),
                className: 'w-full px-6 py-4 rounded-2xl text-2xl mb-4 border-4 border-white/20 bg-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-4 focus:ring-white/40'
              }),
              React.createElement('button', {
                onClick: createGame,
                className: 'w-full bg-gradient-to-r from-green-400 to-green-600 text-white py-4 rounded-2xl text-2xl mb-3 hover:scale-105 transition-transform shadow-2xl'
              }, 'ðŸŽ¯ Create Game'),
              React.createElement('button', {
                onClick: refreshGames,
                className: 'w-full bg-gradient-to-r from-blue-400 to-blue-600 text-white py-4 rounded-2xl text-2xl shadow-2xl hover:scale-105 transition-transform'
              }, 'ðŸ” Browse Games'),
              gameList.length > 0 && React.createElement(
                'div',
                { className: 'mt-6 space-y-2' },
                gameList.map(game => React.createElement(
                  'div',
                  { key: game.id, className: 'bg-white/20 p-4 rounded-xl flex justify-between items-center' },
                  React.createElement('span', { className: 'text-white text-xl' }, `Game ${game.id} (${game.players} players)`),
                  React.createElement('button', {
                    onClick: () => joinGame(game.id),
                    className: 'bg-yellow-500 px-6 py-2 rounded-xl hover:scale-110 transition-transform'
                  }, 'Join')
                ))
              ),
              error && React.createElement('div', { className: 'fixed top-4 right-4 bg-red-500 text-white px-6 py-4 rounded-2xl shadow-2xl animate-bounce' }, error)
            )
          );
        }

        if (view === 'lobby') {
          return React.createElement(
            'div',
            { className: 'min-h-screen flex items-center justify-center p-4' },
            React.createElement(
              'div',
              { className: 'bg-white/10 backdrop-blur-xl rounded-3xl p-8 max-w-2xl w-full' },
              React.createElement('h1', { className: 'text-5xl text-white text-center mb-4' }, 'ðŸŽ® Game Lobby'),
              React.createElement('h2', { className: 'text-3xl text-yellow-300 text-center mb-8' }, `Code: ${gameId}`),
              React.createElement(
                'div',
                { className: 'bg-white/20 rounded-2xl p-6 mb-6' },
                React.createElement('h3', { className: 'text-2xl text-white mb-4' }, `Players (${currentGame?.players.length}/10):`),
                React.createElement(
                  'div',
                  { className: 'space-y-2' },
                  currentGame?.players.map(p => React.createElement(
                    'div',
                    { key: p.id, className: 'bg-white/30 px-6 py-3 rounded-xl text-white text-xl' },
                    `ðŸ‘¤ ${p.name}`
                  ))
                )
              ),
              React.createElement('button', {
                onClick: startGame,
                disabled: currentGame?.players.length < 2,
                className: 'w-full bg-gradient-to-r from-green-400 to-green-600 text-white py-4 rounded-2xl text-2xl disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105 transition-transform shadow-2xl'
              }, 'ðŸš€ Start Game')
            )
          );
        }

        if (view === 'game') {
          const isMyTurn = currentGame?.currentPlayer === socket.id;
          
          return React.createElement(
            'div',
            { className: 'min-h-screen p-4' },
            React.createElement(
              'div',
              { className: 'max-w-7xl mx-auto' },
              React.createElement(
                'div',
                { className: 'flex justify-between items-center mb-6' },
                React.createElement('h2', { className: 'text-4xl text-white' }, `Game ${gameId}`),
                React.createElement('div', { className: `text-3xl px-8 py-3 rounded-2xl ${isMyTurn ? 'bg-green-500 animate-pulse' : 'bg-white/20'}` }, isMyTurn ? 'ðŸŽ¯ YOUR TURN!' : 'â³ Waiting...')
              ),
              React.createElement(
                'div',
                { className: 'grid grid-cols-1 md:grid-cols-3 gap-6 mb-6' },
                React.createElement(
                  'div',
                  { className: 'bg-white/10 backdrop-blur-xl rounded-3xl p-6' },
                  React.createElement('h3', { className: 'text-2xl text-white mb-4' }, 'Top Card:'),
                  currentGame?.topCard && React.createElement('div', { className: 'flex justify-center' }, React.createElement(Card, { card: currentGame.topCard })),
                  React.createElement(
                    'p',
                    { className: 'text-xl text-white text-center mt-4' },
                    'Color: ',
                    React.createElement('span', { className: `font-bold ${currentGame?.currentColor === 'red' ? 'text-uno-red' : currentGame?.currentColor === 'yellow' ? 'text-uno-yellow' : currentGame?.currentColor === 'green' ? 'text-uno-green' : 'text-uno-blue'}` }, currentGame?.currentColor?.toUpperCase())
                  )
                ),
                React.createElement(
                  'div',
                  { className: 'md:col-span-2 bg-white/10 backdrop-blur-xl rounded-3xl p-6' },
                  React.createElement('h3', { className: 'text-2xl text-white mb-4' }, 'Players:'),
                  React.createElement(
                    'div',
                    { className: 'grid grid-cols-2 gap-3' },
                    currentGame?.players.map(p => React.createElement(
                      'div',
                      { key: p.id, className: 'bg-white/20 px-4 py-3 rounded-xl text-white flex justify-between items-center' },
                      React.createElement('span', { className: 'text-lg' }, p.name),
                      React.createElement('span', { className: 'text-xl font-bold' }, `${p.cardCount} ðŸƒ`),
                      p.calledUno && React.createElement('span', { className: 'text-2xl' }, 'ðŸŽ¯')
                    ))
                  )
                )
              ),
              React.createElement(
                'div',
                { className: 'bg-white/10 backdrop-blur-xl rounded-3xl p-6' },
                React.createElement(
                  'div',
                  { className: 'flex justify-between items-center mb-4' },
                  React.createElement('h3', { className: 'text-2xl text-white' }, `Your Hand (${myHand.length} cards):`),
                  React.createElement(
                    'div',
                    { className: 'space-x-3' },
                    React.createElement('button', {
                      onClick: drawCard,
                      disabled: !isMyTurn,
                      className: 'bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-xl text-xl disabled:opacity-50 hover:scale-110 transition-transform shadow-lg'
                    }, 'ðŸŽ´ Draw Card'),
                    React.createElement('button', {
                      onClick: callUno,
                      disabled: myHand.length !== 1,
                      className: 'bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-6 py-3 rounded-xl text-xl disabled:opacity-50 hover:scale-110 transition-transform shadow-lg'
                    }, 'ðŸŽ¯ UNO!')
                  )
                ),
                React.createElement(
                  'div',
                  { className: 'flex gap-4 overflow-x-auto pb-4' },
                  myHand.map((card, index) => React.createElement(Card, {
                    key: index,
                    card: card,
                    onClick: isMyTurn ? () => playCard(index, card) : null,
                    className: isMyTurn ? 'hover:scale-110' : 'opacity-70 cursor-not-allowed'
                  }))
                )
              ),
              error && React.createElement('div', { className: 'fixed top-4 right-4 bg-red-500 text-white px-6 py-4 rounded-2xl shadow-2xl' }, error)
            )
          );
        }
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(App));
    </script>
  </body>
</html>
